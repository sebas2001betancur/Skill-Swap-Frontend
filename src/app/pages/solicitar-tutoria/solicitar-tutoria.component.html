<div class="min-h-screen bg-gradient-to-br from-blue-50 via-indigo-50 to-purple-50">
  <div class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-8">

    <!-- Header -->
    <div class="mb-8 text-center">
      <div class="inline-flex items-center justify-center w-20 h-20 bg-gradient-to-r from-purple-500 to-pink-600 rounded-2xl mb-6 shadow-2xl transform hover:scale-105 transition-transform">
        <mat-icon class="text-white !text-4xl">school</mat-icon>
      </div>
      <h1 class="text-5xl md:text-6xl font-black bg-gradient-to-r from-gray-900 via-purple-800 to-pink-800 bg-clip-text text-transparent mb-4">
        Solicitar Tutoría
      </h1>
      <p class="text-lg text-gray-600 max-w-2xl mx-auto leading-relaxed">
        Envía tu solicitud para participar en esta tutoría y comienza tu aprendizaje
      </p>
    </div>

    <!-- Loading -->
    <div *ngIf="isLoading" class="flex flex-col items-center justify-center py-24">
      <div class="relative mb-6">
        <div class="w-20 h-20 border-4 border-purple-200 border-t-purple-600 rounded-full animate-spin"></div>
        <div class="absolute inset-0 bg-gradient-to-r from-purple-400 to-pink-500 rounded-full animate-pulse opacity-20"></div>
      </div>
      <p class="text-gray-700 text-xl font-bold">Cargando información de la tutoría...</p>
      <p class="text-gray-500 text-sm mt-2">Esto solo tomará un momento</p>
    </div>

    <!-- Content -->
    <div *ngIf="!isLoading && tutoria" class="grid lg:grid-cols-3 gap-8">

      <!-- Tutoría Info -->
      <div class="lg:col-span-2">
        <mat-card class="bg-white/90 backdrop-blur-sm border border-white/20 rounded-2xl shadow-lg">
          <mat-card-header class="pb-4">
            <div class="flex items-center gap-3">
              <div class="w-12 h-12 bg-gradient-to-r from-purple-500 to-pink-600 rounded-xl flex items-center justify-center">
                <mat-icon class="text-white">book</mat-icon>
              </div>
              <div>
                <mat-card-title class="text-2xl font-bold text-gray-900">{{ tutoria.titulo }}</mat-card-title>
                <mat-card-subtitle class="text-purple-600 font-medium">{{ tutoria.materia }}</mat-card-subtitle>
              </div>
            </div>
          </mat-card-header>

          <mat-card-content class="space-y-6">
            <p class="text-gray-700 leading-relaxed">{{ tutoria.descripcion }}</p>

            <div class="grid md:grid-cols-2 gap-4">
              <div class="flex items-center gap-3">
                <mat-icon class="text-purple-500">person</mat-icon>
                <div>
                  <p class="text-sm text-gray-500">Mentor</p>
                  <p class="font-medium">{{ tutoria.mentorNombre }}</p>
                </div>
              </div>

              <div class="flex items-center gap-3">
                <mat-icon class="text-purple-500">schedule</mat-icon>
                <div>
                  <p class="text-sm text-gray-500">Fecha y Hora</p>
                  <p class="font-medium">{{ formatearFecha(tutoria.fechaHora) }}</p>
                </div>
              </div>

              <div class="flex items-center gap-3">
                <mat-icon class="text-purple-500">location_on</mat-icon>
                <div>
                  <p class="text-sm text-gray-500">Modalidad</p>
                  <p class="font-medium">{{ tutoria.modalidad }}</p>
                </div>
              </div>

              <div class="flex items-center gap-3">
                <mat-icon class="text-purple-500">group</mat-icon>
                <div>
                  <p class="text-sm text-gray-500">Cupos</p>
                  <p class="font-medium">{{ getCuposDisponibles() }} disponibles</p>
                </div>
              </div>
            </div>

            <div class="flex flex-wrap gap-2">
              <mat-chip [color]="getNivelColor(tutoria.nivelRequerido)" selected>
                {{ tutoria.nivelRequerido }}
              </mat-chip>
              <mat-chip color="accent" selected>
                {{ tutoria.materia }}
              </mat-chip>
            </div>

            <div *ngIf="tutoria.temasEspecificos && tutoria.temasEspecificos.length > 0" class="mt-4">
              <h4 class="font-semibold text-gray-900 mb-2">Temas específicos:</h4>
              <div class="flex flex-wrap gap-2">
                <mat-chip *ngFor="let tema of tutoria.temasEspecificos" color="primary" selected>
                  {{ tema }}
                </mat-chip>
              </div>
            </div>
          </mat-card-content>
        </mat-card>
      </div>

      <!-- Solicitud Form -->
      <div class="lg:col-span-1">
        <mat-card class="bg-white/90 backdrop-blur-sm border border-white/20 rounded-2xl shadow-lg sticky top-8">
          <mat-card-header class="pb-4">
            <mat-card-title class="text-xl font-bold text-gray-900">Enviar Solicitud</mat-card-title>
            <mat-card-subtitle class="text-gray-600">Completa la información para participar</mat-card-subtitle>
          </mat-card-header>

          <mat-card-content>
            <form [formGroup]="solicitudForm" (ngSubmit)="onSubmit()" class="space-y-4">

              <!-- Mensaje -->
              <mat-form-field appearance="outline" class="w-full">
                <mat-label>Mensaje para el mentor (opcional)</mat-label>
                <textarea matInput
                          formControlName="mensaje"
                          placeholder="Cuéntale al mentor por qué quieres participar en esta tutoría..."
                          rows="4"
                          maxlength="500"></textarea>
                <mat-hint align="end">{{ getMensajeContador() }}</mat-hint>
              </mat-form-field>

              <!-- Estado de cupos -->
              <div *ngIf="!hayCuposDisponibles()" class="p-3 bg-red-50 border border-red-200 rounded-lg">
                <div class="flex items-center gap-2">
                  <mat-icon class="text-red-500 text-sm">warning</mat-icon>
                  <span class="text-red-700 text-sm font-medium">No hay cupos disponibles</span>
                </div>
              </div>

              <!-- Ya solicitado -->
              <div *ngIf="yaSolicitado" class="p-3 bg-yellow-50 border border-yellow-200 rounded-lg">
                <div class="flex items-center gap-2">
                  <mat-icon class="text-yellow-500 text-sm">info</mat-icon>
                  <span class="text-yellow-700 text-sm font-medium">Ya tienes una solicitud pendiente</span>
                </div>
              </div>

              <!-- Fecha pasada -->
              <div *ngIf="tutoriaPasada" class="p-3 bg-red-50 border border-red-200 rounded-lg">
                <div class="flex items-center gap-2">
                  <mat-icon class="text-red-500 text-sm">event_busy</mat-icon>
                  <span class="text-red-700 text-sm font-medium">Esta tutoría ya no está disponible</span>
                </div>
              </div>

            </form>
          </mat-card-content>

          <mat-card-actions class="px-6 pb-6 flex flex-col gap-3">
            <button mat-raised-button
                    color="primary"
                    class="w-full rounded-xl py-3"
                    [disabled]="solicitudForm.invalid || isSubmitting || !hayCuposDisponibles() || yaSolicitado || tutoriaPasada"
                    (click)="onSubmit()">
              <mat-icon *ngIf="!isSubmitting" class="mr-2">send</mat-icon>
              <mat-spinner *ngIf="isSubmitting" diameter="20" class="mr-2"></mat-spinner>
              {{ isSubmitting ? 'Enviando...' : 'Enviar Solicitud' }}
            </button>

            <button mat-stroked-button
                    color="accent"
                    class="w-full rounded-xl"
                    (click)="cancelar()">
              <mat-icon class="mr-2">arrow_back</mat-icon>
              Volver
            </button>
          </mat-card-actions>
        </mat-card>
      </div>

    </div>

  </div>
</div>
