<div class="min-h-screen bg-gradient-to-br from-blue-50 via-indigo-50 to-purple-50">
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">

    <!-- Header -->
    <div class="mb-12 text-center">
      <div class="inline-flex items-center justify-center w-20 h-20 bg-gradient-to-r from-purple-500 to-pink-600 rounded-2xl mb-6 shadow-2xl transform hover:scale-105 transition-transform">
        <mat-icon class="text-white !text-4xl">assignment</mat-icon>
      </div>
      <h1 class="text-5xl md:text-6xl font-black bg-gradient-to-r from-gray-900 via-purple-800 to-pink-800 bg-clip-text text-transparent mb-4">
        Mis Solicitudes
      </h1>
       <p class="text-lg text-gray-600 max-w-2xl mx-auto leading-relaxed">
         Gestiona tus solicitudes de tutorías enviadas y revisa el estado de cada una
       </p>

       <!-- Botón de diagnóstico -->
       <div class="mt-6">
         <button mat-stroked-button color="accent" (click)="diagnosticar()"
                 class="px-4 py-2 rounded-lg border-2 border-purple-300 text-purple-700 hover:bg-purple-50">
           <mat-icon class="mr-2">bug_report</mat-icon>
           Diagnosticar Problemas
         </button>
       </div>
    </div>

    <!-- Loading -->
    <div *ngIf="isLoading" class="flex flex-col items-center justify-center py-24">
      <div class="relative mb-6">
        <div class="w-20 h-20 border-4 border-purple-200 border-t-purple-600 rounded-full animate-spin"></div>
        <div class="absolute inset-0 bg-gradient-to-r from-purple-400 to-pink-500 rounded-full animate-pulse opacity-20"></div>
      </div>
      <p class="text-gray-700 text-xl font-bold">Cargando tus solicitudes...</p>
      <p class="text-gray-500 text-sm mt-2">Esto solo tomará un momento</p>
    </div>

    <!-- Content -->
    <div *ngIf="!isLoading" class="bg-white/90 backdrop-blur-md rounded-3xl shadow-2xl overflow-hidden">
      <mat-tab-group [(selectedIndex)]="selectedTab" class="solicitudes-tabs">

        <!-- Solicitudes Enviadas (Estudiante) -->
        <mat-tab>
          <ng-template mat-tab-label>
            <div class="flex items-center gap-2 px-4 py-2">
              <mat-icon>send</mat-icon>
              <span class="font-bold">Solicitudes Enviadas</span>
              <span *ngIf="solicitudesEnviadas.length > 0" 
                    class="ml-2 px-2 py-1 bg-purple-100 text-purple-700 rounded-full text-xs font-bold">
                {{ solicitudesEnviadas.length }}
              </span>
            </div>
          </ng-template>

          <div class="p-8">
            <!-- Sin solicitudes -->
            <div *ngIf="solicitudesEnviadas.length === 0" class="text-center py-20">
              <div class="w-32 h-32 bg-gradient-to-r from-purple-200 to-pink-300 rounded-full flex items-center justify-center mx-auto mb-8 shadow-xl">
                <mat-icon class="text-purple-600 !text-6xl">assignment</mat-icon>
              </div>
              <h3 class="text-3xl font-black text-gray-900 mb-4">No has enviado solicitudes</h3>
              <p class="text-gray-600 mb-8 max-w-md mx-auto text-lg">
                Explora las tutorías disponibles y envía tu primera solicitud para comenzar tu aprendizaje.
              </p>
              <button mat-raised-button routerLink="/buscar-tutorias"
                      class="px-8 py-4 rounded-xl shadow-lg hover:shadow-xl transition-all bg-gradient-to-r from-purple-500 to-pink-600 hover:from-purple-600 hover:to-pink-700 text-white font-bold">
                <mat-icon class="mr-2">search</mat-icon>
                Buscar Tutorías
              </button>
            </div>

            <!-- Lista de solicitudes enviadas -->
            <div *ngIf="solicitudesEnviadas.length > 0">
              <!-- Contador -->
              <div class="mb-6">
                <p class="text-gray-700 font-bold text-lg">
                  Tienes <span class="text-purple-600">{{ solicitudesEnviadas.length }}</span> solicitud(es) enviada(s)
                </p>
              </div>

              <div class="grid gap-6 sm:grid-cols-2 lg:grid-cols-3">
                <div *ngFor="let solicitud of solicitudesEnviadas"
                      class="group cursor-pointer bg-white border-2 border-gray-100 rounded-2xl shadow-md hover:shadow-2xl hover:border-purple-300 transition-all duration-300 transform hover:-translate-y-2 overflow-hidden">

                  <!-- Header con gradiente -->
                  <div class="relative h-20 bg-gradient-to-r from-purple-500 to-pink-500 p-4 flex items-center justify-between">
                    <div class="flex items-center gap-3">
                      <div class="w-12 h-12 bg-white/20 backdrop-blur-sm rounded-xl flex items-center justify-center shadow-lg">
                        <mat-icon class="text-white !text-xl">school</mat-icon>
                      </div>
                      <div>
                        <p class="text-white text-xs font-bold opacity-90">Solicitud</p>
                        <p class="text-white text-lg font-black">#{{ solicitud.id.slice(-6) }}</p>
                      </div>
                    </div>
                    
                    <!-- Badge de estado -->
                    <span class="px-3 py-1 rounded-full text-xs font-bold bg-white/90 backdrop-blur-sm shadow-lg"
                          [ngClass]="{
                            'text-yellow-700': solicitud.estado === 'Pendiente',
                            'text-green-700': solicitud.estado === 'Aceptada' || solicitud.estado === 'Aceptado',
                            'text-red-700': solicitud.estado === 'Rechazada' || solicitud.estado === 'Rechazado'
                          }">
                      <mat-icon class="!text-sm mr-1 align-middle">{{ getEstadoIcon(solicitud.estado) }}</mat-icon>
                      {{ solicitud.estado }}
                    </span>
                  </div>

                  <!-- Contenido -->
                  <div class="p-5 space-y-4">
                    <!-- Mensaje -->
                    <div *ngIf="solicitud.mensaje" class="p-3 bg-gradient-to-r from-purple-50 to-pink-50 rounded-xl border border-purple-100">
                      <p class="text-xs text-gray-600 font-bold mb-1">Tu mensaje:</p>
                      <p class="text-sm text-gray-700 italic line-clamp-3">"{{ solicitud.mensaje }}"</p>
                    </div>

                    <!-- Info -->
                    <div class="flex items-center gap-3 p-3 bg-gray-50 rounded-xl">
                      <div class="w-10 h-10 bg-purple-100 rounded-lg flex items-center justify-center">
                        <mat-icon class="text-purple-600 !text-base">event</mat-icon>
                      </div>
                      <div class="flex-1 min-w-0">
                        <p class="text-xs text-gray-600 font-bold">Enviada el</p>
                        <p class="text-sm text-gray-900 font-bold truncate">{{ formatearFecha(solicitud.fechaCreacion) }}</p>
                      </div>
                    </div>

                    <!-- Botón -->
                    <button mat-stroked-button 
                            class="w-full py-3 rounded-xl border-2 border-purple-300 text-purple-700 hover:bg-purple-50 font-bold transition-all"
                            (click)="verDetallesTutoria(solicitud.tutoriaId)">
                      <mat-icon class="mr-2">visibility</mat-icon>
                      Ver Tutoría
                    </button>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </mat-tab>

        <!-- Solicitudes Recibidas (Mentor) -->
        <mat-tab>
          <ng-template mat-tab-label>
            <div class="flex items-center gap-2 px-4 py-2">
              <mat-icon>inbox</mat-icon>
              <span class="font-bold">Solicitudes Recibidas</span>
              <span class="ml-2 px-2 py-1 bg-blue-100 text-blue-700 rounded-full text-xs font-bold">
                {{ solicitudesRecibidas.length }}
              </span>
              <span *ngIf="!esMentor" class="ml-2 text-xs text-gray-500">(Testing)</span>
            </div>
          </ng-template>

          <div class="p-8">
            <!-- Sin solicitudes -->
            <div *ngIf="solicitudesRecibidas.length === 0" class="text-center py-20">
              <div class="w-32 h-32 bg-gradient-to-r from-blue-200 to-purple-300 rounded-full flex items-center justify-center mx-auto mb-8 shadow-xl">
                <mat-icon class="text-blue-600 !text-6xl">inbox</mat-icon>
              </div>
              <h3 class="text-3xl font-black text-gray-900 mb-4">No tienes solicitudes pendientes</h3>
              <p class="text-gray-600 mb-8 max-w-md mx-auto text-lg">
                Cuando los estudiantes soliciten participar en tus tutorías, aparecerán aquí para que puedas gestionarlas.
              </p>
            </div>

            <!-- Lista de solicitudes recibidas -->
            <div *ngIf="solicitudesRecibidas.length > 0">
              <!-- Contador -->
              <div class="mb-6">
                <p class="text-gray-700 font-bold text-lg">
                  Tienes <span class="text-blue-600">{{ solicitudesRecibidas.length }}</span> solicitud(es) recibida(s)
                </p>
              </div>

              <div class="grid gap-6 sm:grid-cols-2 lg:grid-cols-3">
                <div *ngFor="let solicitud of solicitudesRecibidas"
                      class="group bg-white border-2 border-gray-100 rounded-2xl shadow-md hover:shadow-2xl hover:border-blue-300 transition-all duration-300 transform hover:-translate-y-2 overflow-hidden">

                  <!-- Header con gradiente -->
                  <div class="relative h-20 bg-gradient-to-r from-blue-500 to-purple-500 p-4 flex items-center justify-between">
                    <div class="flex items-center gap-3">
                      <div class="w-12 h-12 bg-white/20 backdrop-blur-sm rounded-full flex items-center justify-center shadow-lg">
                        <mat-icon class="text-white !text-xl">person</mat-icon>
                      </div>
                      <div class="flex-1 min-w-0">
                        <p class="text-white text-xs font-bold opacity-90">Estudiante</p>
                        <p class="text-white text-lg font-black truncate">{{ solicitud.estudianteNombre }}</p>
                      </div>
                    </div>
                    
                    <!-- Badge de estado -->
                    <span class="px-3 py-1 rounded-full text-xs font-bold bg-white/90 backdrop-blur-sm shadow-lg flex-shrink-0"
                          [ngClass]="{
                            'text-yellow-700': solicitud.estado === 'Pendiente',
                            'text-green-700': solicitud.estado === 'Aceptada' || solicitud.estado === 'Aceptado',
                            'text-red-700': solicitud.estado === 'Rechazada' || solicitud.estado === 'Rechazado'
                          }">
                      <mat-icon class="!text-sm mr-1 align-middle">{{ getEstadoIcon(solicitud.estado) }}</mat-icon>
                      {{ solicitud.estado }}
                    </span>
                  </div>

                  <!-- Contenido -->
                  <div class="p-5 space-y-4">
                    <!-- Mensaje -->
                    <div *ngIf="solicitud.mensaje" class="p-3 bg-gradient-to-r from-blue-50 to-indigo-50 rounded-xl border border-blue-100">
                      <p class="text-xs text-gray-600 font-bold mb-1">Mensaje del estudiante:</p>
                      <p class="text-sm text-gray-700 italic">"{{ solicitud.mensaje }}"</p>
                    </div>

                    <!-- Info -->
                    <div class="flex items-center gap-3 p-3 bg-gray-50 rounded-xl">
                      <div class="w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center">
                        <mat-icon class="text-blue-600 !text-base">event</mat-icon>
                      </div>
                      <div class="flex-1 min-w-0">
                        <p class="text-xs text-gray-600 font-bold">Recibida el</p>
                        <p class="text-sm text-gray-900 font-bold truncate">{{ formatearFecha(solicitud.fechaCreacion) }}</p>
                      </div>
                    </div>

                    <!-- Botones de acción -->
                    <div class="flex gap-2 pt-2">
                      <button mat-raised-button
                              color="primary"
                              class="flex-1 py-3 rounded-xl shadow-md hover:shadow-lg transition-all disabled:opacity-50"
                              [disabled]="solicitud.estado !== 'Pendiente'"
                              (click)="aceptarSolicitud(solicitud)">
                        <mat-icon class="mr-1 !text-base">check</mat-icon>
                        <span class="font-bold">Aceptar</span>
                      </button>
                      <button mat-raised-button
                              color="warn"
                              class="flex-1 py-3 rounded-xl shadow-md hover:shadow-lg transition-all disabled:opacity-50"
                              [disabled]="solicitud.estado !== 'Pendiente'"
                              (click)="rechazarSolicitud(solicitud)">
                        <mat-icon class="mr-1 !text-base">close</mat-icon>
                        <span class="font-bold">Rechazar</span>
                      </button>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </mat-tab>

      </mat-tab-group>
    </div>

  </div>
</div>